<f:view xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:layout="http://www.apusic.com/jsf/layout"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:w="http://www.apusic.com/jsf/widget"
	xmlns:ajax="http://www.apusic.com/jsf/ajax" renderKitId="AJAX">

	<layout:window title="" width="199" id="timeChooseWindow" modal="true" 
		jsvar="timeChooseWindowJsVar" height="293" header="false" resizable="true" constrainHeader="true" border="false" bodyStyle="thin" onactivate="hJsVar.focus()">
		 <w:form>
	            <w:calendar id="calendar" jsvar="calendarJsVar" />
	            <layout:panelGrid columns="10">
	            <w:numberField width="50" jsvar="hJsVar" minValue="0" maxValue="23" style="text-align: center" selectOnFocus="true" required="true" tabIndex="1"></w:numberField>
	            <h:outputLabel value=":" style="font-weight: bold;padding-bottom: 10px;" />
	            <w:numberField width="50" jsvar="mJsVar" minValue="0" maxValue="59" style="text-align: center" selectOnFocus="true" required="true" tabIndex="2"></w:numberField>
	            <h:outputLabel value=":" style="font-weight: bold;padding-bottom: 10px;" />
	            <w:numberField width="50" jsvar="sJsVar" minValue="0" maxValue="59" style="text-align: center" selectOnFocus="true" required="true" tabIndex="3"></w:numberField>
	            </layout:panelGrid>
	            <layout:panelGrid columns="2">
	            	<w:button value="#{l.m['取消']}Esc" width="85" onclick="timeChooseWindowJsVar.hide()" style="background-color: #20807F" tabindex="4"/>
	            	<w:button value="#{l.m['确定']}Enter" jsvar="confirmeBtnJsVar" width="85" onclick="confirmTime()" style="background-color: #20807F" tabindex="5"/>
	            </layout:panelGrid>
	            <ajax:keyBinding key="ENTER" target="timeChooseWindow" clientScript="if(!timeChooseWindowJsVar.hidden){confirmeBtnJsVar.fireEvent('click');}" />
        </w:form>
        
	</layout:window>


<script>
	//<![CDATA[
	var currentTarget;
	function showTime(target , x , y){
		timeChooseWindowJsVar.hide();
		currentTarget = target;
		$(".x-date-time-menu").hide();
		$(".x-shadow").hide()
		var crtTime = target.getValue();
		timeChooseWindowJsVar.x=x;
		timeChooseWindowJsVar.y=y;
		console.log(crtTime); 
		if(crtTime == undefined || crtTime == null || crtTime == ""){
			crtTime = new Date();
		}
		calendarJsVar.setValue(crtTime);
		hJsVar.setValue(crtTime.getHours());
		mJsVar.setValue(crtTime.getMinutes());
		sJsVar.setValue(crtTime.getSeconds());
		timeChooseWindowJsVar.show();
		
		setTimeout(function(){hJsVar.focus();}, 1000);
	}

	function confirmTime(){
		var date = calendarJsVar.getValue();
		var time = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate() + " " + hJsVar.getValue() + ":" + mJsVar.getValue() + ":" + sJsVar.getValue();
		console.log(time);
		var crtTime = new Date(time);
		currentTarget.setValue(crtTime);
		currentTarget.fireEvent('change');
		timeChooseWindowJsVar.hide();
	}
 //]]>	
</script>

</f:view>


<!-- 	
<ui:include src="/common/datetimechooser.xhtml"/>  
$("input[id*='sidate']").next('img').bind("click", function(){
  showTime(sidateJsVar , 720 , 142);
});
 -->