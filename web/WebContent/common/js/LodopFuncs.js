var CreatedOKLodop7766=null;function needCLodop(){try{var d=navigator.userAgent;if(d.match(/Windows\sPhone/i)!=null){return true;}if(d.match(/iPhone|iPod/i)!=null){return true;}if(d.match(/Android/i)!=null){return true;}if(d.match(/Edge\D?\d+/i)!=null){return true;}var f=d.match(/Trident\D?\d+/i);var b=d.match(/MSIE\D?\d+/i);var h=d.match(/OPR\D?\d+/i);var g=d.match(/Firefox\D?\d+/i);var c=d.match(/x64/i);if((f==null)&&(b==null)&&(c!==null)){return true;}else{if(g!==null){g=g[0].match(/\d+/);if((g[0]>=42)||(c!==null)){return true;}}else{if(h!==null){h=h[0].match(/\d+/);if(h[0]>=32){return true;}}else{if((f==null)&&(b==null)){var a=d.match(/Chrome\D?\d+/i);if(a!==null){a=a[0].match(/\d+/);if(a[0]>=42){return true;}}}}}}return false;}catch(e){return true;}}if(needCLodop()){var head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;var oscript=document.createElement("script");oscript.src="http://localhost:8000/CLodopfuncs.js?priority=1";head.insertBefore(oscript,head.firstChild);oscript=document.createElement("script");oscript.src="http://localhost:18000/CLodopfuncs.js?priority=0";head.insertBefore(oscript,head.firstChild);}function getLodop(g,i){var m="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>";var j="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>";var b="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>";var k="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>";var f="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>";var c="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>";var e="<br><font color='#FF00FF'>CLodop云打印服务(localhost本地)未安装启动!点击这里<a href='http://ufms.cn/file/CLodop_Setup_for_Win32NT.exe' target='_self'>执行安装</a>,安装后请刷新页面。</font>";var n="<br><font color='#FF00FF'>CLodop云打印服务需升级!点击这里<a href='http://ufms.cn/file/CLodop_Setup_for_Win32NT.exe' target='_self'>执行升级</a>,升级后请刷新页面。</font>";var l;try{var d=(navigator.userAgent.indexOf("MSIE")>=0)||(navigator.userAgent.indexOf("Trident")>=0);if(needCLodop()){try{l=getCLodop();}catch(h){}if(!l&&document.readyState!=="complete"){alert("C-Lodop没准备好，请稍后再试！");return;}if(!l){if(d){document.write(e);}else{document.documentElement.innerHTML=e+document.documentElement.innerHTML;}return;}else{if(CLODOP.CVERSION<"2.0.9.3"){if(d){document.write(n);}else{document.documentElement.innerHTML=n+document.documentElement.innerHTML;}}if(i&&i.parentNode){i.parentNode.removeChild(i);}if(g&&g.parentNode){g.parentNode.removeChild(g);}}}else{var a=d&&(navigator.userAgent.indexOf("x64")>=0);if(g!=undefined||i!=undefined){if(d){l=g;}else{l=i;}}else{if(CreatedOKLodop7766==null){l=document.createElement("object");l.setAttribute("width",0);l.setAttribute("height",0);l.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;");if(d){l.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA");}else{l.setAttribute("type","application/x-print-lodop");}document.documentElement.appendChild(l);CreatedOKLodop7766=l;}else{l=CreatedOKLodop7766;}}if((l==null)||(typeof(l.VERSION)=="undefined")){if(navigator.userAgent.indexOf("Chrome")>=0){document.documentElement.innerHTML=c+document.documentElement.innerHTML;}if(navigator.userAgent.indexOf("Firefox")>=0){document.documentElement.innerHTML=f+document.documentElement.innerHTML;}if(a){document.write(b);}else{if(d){document.write(m);}else{document.documentElement.innerHTML=m+document.documentElement.innerHTML;}}return l;}}if(l.VERSION<"6.2.1.6"){if(needCLodop()){document.documentElement.innerHTML=n+document.documentElement.innerHTML;}else{if(a){document.write(k);}else{if(d){document.write(j);}else{document.documentElement.innerHTML=j+document.documentElement.innerHTML;}}}return l;}l.SET_LICENSES("","642444555575061585558561289003","688858710010010811411756128900","");return l;}catch(h){alert("getLodop出错:"+h);}}