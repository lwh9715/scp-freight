<?xml version="1.0" encoding="UTF-8"?>
<f:view xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:w="http://www.apusic.com/jsf/widget" xmlns:layout="http://www.apusic.com/jsf/layout"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:ajax="http://www.apusic.com/jsf/ajax"
	xmlns:ui="http://java.sun.com/jsf/facelets" renderKitId="AJAX">
	<w:head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="shortcut icon" href="#{constantBean.contextPath}/favicon.ico" />
		<link rel="icon" type="image/gif" href="#{constantBean.contextPath}/favicon.ico" />
		<w:stylesheet src="/common/css/common.css"></w:stylesheet><link rel="stylesheet" id="cmsbg" type="text/css"/>
		
		<w:stylesheet src="/common/css/bootstrap.css"></w:stylesheet>
		
		<script type="text/javascript" src="/scp/common/js/jquery.min.js"></script>
	
		<script type="text/javascript" src="/scp/_global/resource/ext/src/locale/ext-lang.js?#{commonBean.lang}"></script>
		<script type="text/javascript" src="/scp/_global/resource/om/locale/om-lang.js?#{commonBean.lang}"></script>
		
		<style type="text/css">
			.table-result{
			    width:100%;
			    border:1px solid #f2f2f2;
			    text-align:left;
			    border-collapse: collapse;
			}
			.table-result th{
			    height:40px;
			    font-weight: bold;
			    font-size:14px;
			    line-height:22px;
			    text-align:left;
			    background-color:#f0f0f0;
			    border-right:2px solid #fff;
			    color:#4e4e4e;
			    border-style: solid;
			    border-width: 1px;
			    border-color: gray;
			}
			.table-result td{
			    text-align:left;
			    height:40px;
			    font-size:12px;
			    line-height:22px;
			    color:#4e4e4e;
			    border-style: solid;
			    border-width: 1px;
			    border-color: gray;
			    padding-left: 2px;
			    padding-right:2px;
			}
			td
			{
			white-space:nowrap;
			 
			}
			
		</style>
		
	</w:head>
	<w:page loadMask="true" loadMaskText="Loading..." title="">
		<ajax:conversationActivator/>
		<layout:borderLayout>
			<layout:panel region="north" height="200" split="true">
				<w:form >
					<w:button id="execQuery" value="Qurey" image="#{constantBean.contextPath}/images/refresh.png" />
					<layout:panelGrid columns="1">
						<w:textArea width="850" height="170" id="sqlText" jsvar="sqlTextJsVar" style="font-size: 18px;" selectOnFocus="true"/>
					</layout:panelGrid>
					<w:textArea id="sqlResult" jsvar="sqlResultJsVar" hidden="true"></w:textArea>
				</w:form>
			</layout:panel>	
			
			<layout:panel region="center" autoHeight="true">
				<div style="width:100%; height:750px; overflow:scroll;" id="sqlResultPanel" >
				</div>	
			</layout:panel>	
		</layout:borderLayout>
		
	</w:page>
	

<script>	
//<![CDATA[
	function showSqlResult(){
		var res = sqlResultJsVar.getValue();
		var json = JSON.parse(res);
		if(!json.success){
			alert(json.message);
			return;
		}
		json = json.data;
		json = JSON.parse(json);
		var index = 0;
		var html = "";
		var t1="<table class=table-result "+id+" ><thead><tr>";
        var flag=0;
        
        
	    for(var col in json[0]){
	        //console.log("col:"+col);
	        //console.log("val:"+json[0][col]);
	        if(flag==0){
	        	if(col!=""){
                   t1+="<th class=center style='font-size:10px;height:15px;width:100%;'>"+col+"</th>";
                }
	        }
	    }
	    t1+="</tr></thead>";
		for(var i =0;i<json.length;i++){
			var tr_row="<tr>";
		    for(var col in json[i]){
		    	var val = json[i][col];
		    	if(val == null)val='';
		        //console.log("col:"+col);
		        //console.log("val:"+val);
		        tr_row+="<td align=center style='height:15px;width:100%;'>"+val+"</td>";
		    }
		    tr_row+="</tr>";
		    t1+=tr_row;
		}
		t1+="</table>";

	    $('#sqlResultPanel').empty();
	    $('#sqlResultPanel').append(t1);
	}
	
	Ext.onReady(function(){
     });
	
	
 //]]>	
</script>

</f:view>

