<?xml version="1.0" encoding="UTF-8"?>
<f:view xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:w="http://www.apusic.com/jsf/widget" xmlns:layout="http://www.apusic.com/jsf/layout"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:ajax="http://www.apusic.com/jsf/ajax"
	xmlns:ui="http://java.sun.com/jsf/facelets" renderKitId="AJAX">
	<w:head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	
		<script type="text/javascript" src="/scp/_global/resource/ext/src/locale/ext-lang.js?#{commonBean.lang}"></script>
		<script type="text/javascript" src="/scp/_global/resource/om/locale/om-lang.js?#{commonBean.lang}"></script>
	</w:head>
	<w:page title="#{l.m['储位明细']}" loadMask="false">
		<ajax:conversationActivator/>
		<layout:borderLayout fitToBody="true">
			<layout:panel id="gridPanel" jsvar="gridPanelJsvar" height="100%" split="true" fit="true"
				title=""  hideBorders="true" region="center">
		<w:form>
			<ajax:submitAction id="changeLocal" jsvar="changeLocal" />
			<w:toolBar>
				<w:button id="qryRefresh" label="#{l.m['刷新']}"
					image="#{constantBean.contextPath}/images/refresh.png" />

				<w:button id="showLoc" label="#{l.m['查看储位']}" onclick="showLoc()"
					image="#{constantBean.contextPath}/images/refresh.png" />
				<w:button id="save" jsvar="save" label="#{l.m['保存']}"
					image="#{constantBean.contextPath}/images/save.png" />
			</w:toolBar>
			<layout:panelGrid columns="3" style="font-size:12px">
				<h:outputText id="locdesc" />
			</layout:panelGrid>
			<!-- id 运单号  入库单号  货物名称  -->
			<layout:panelGrid columns="20" cellspacing="0" cellpadding="0">
				<layout:cell style="width: 25px;">
					<w:button id="clearQryKey" label="" width="25"
						image="#{constantBean.contextPath}/images/clear.png" />
				</layout:cell>
				<w:textField width="80"
					value="#{pages.module.data.warehouselocaldtlBean.qryMap['customerabbr']}" />
				<w:textField width="80" value="#{pages.module.data.warehouselocaldtlBean.qryMap['goodscode']}" />
				<w:textField width="80" value="#{pages.module.data.warehouselocaldtlBean.qryMap['goodsnamec']}" />
				<w:textField width="80" value="#{pages.module.data.warehouselocaldtlBean.qryMap['markno']}" />
				<w:textField width="80" value="#{pages.module.data.warehouselocaldtlBean.qryMap['goodssize']}" />
				<w:textField width="80" value="#{pages.module.data.warehouselocaldtlBean.qryMap['goodscolor']}" />
				<w:button id="refresh" value="#{l.m['查询']}"
					image="#{constantBean.contextPath}/images/query-small.png" />
			</layout:panelGrid>

			<!-- id 运单号  入库单号  货物名称  -->
			<w:editDataGrid id="editGrid" height="350" paged="true" rows="10" toolBarPosition="bottom" jsvar="gridJsvar"
				idColumn="id" loadMask="false" remoteSort="true">
				<w:outputColumn id="id" header="ID" hidden="true" />
				<w:outputColumn header="#{l.m['客户']}" id="customerabbr" width="80" sortable="true" />
				<w:outputColumn header="#{l.m['货品代码']}" id="goodscode" width="100" sortable="true" />
				<w:outputColumn header="#{l.m['货品名称']}(CN)" id="goodsnamec" width="100" sortable="true" />
				<w:outputColumn header="#{l.m['唛头']}" id="markno" width="80" sortable="true" />
				<w:outputColumn header="#{l.m['规格型号']}" id="goodssize" width="80" sortable="true" />
				<w:outputColumn header="#{l.m['颜色']}" id="goodscolor" width="80" sortable="true" />
				<w:outputColumn header="#{l.m['入库时间']}" id="singtime" width="110" sortable="true">
					<f:convertDateTime pattern="yy/MM/dd HH:mm" timeZone="GMT+8" />
				</w:outputColumn>
				<w:outputColumn header="#{l.m['每箱件数']}" id="pieceinbox" width="80" align="right" sortable="true" />
				<w:outputColumn header="#{l.m['箱数']}" id="stockbox" align="right" width="70" sortable="true">
				</w:outputColumn>
				<w:outputColumn header="#{l.m['件数']}" id="pieces_desc" align="right" width="70" sortable="true"
					jsvar="piecedesc" onclick="setPiece();">
				</w:outputColumn>
				<w:outputColumn header="#{l.m['调整件数']}" id="pieceout" width="80" sortable="true"
					jsvar="pieceout" style="background-color: #B3F8AF" align="right">
					<w:numberField id="pieceoutEdit"></w:numberField>
				</w:outputColumn>
				<w:outputColumn header="#{l.m['目的储位']}" id="locagent" width="100" sortable="true"
					style="background-color: #B3F8AF" align="right">
					<w:textField id="locagentEdit"></w:textField>
				</w:outputColumn>
			</w:editDataGrid>
		</w:form>
		</layout:panel>
		</layout:borderLayout>
	</w:page>

	<layout:window maximizable="true" id="editWindow" width="800" height="500" modal="false">
		<layout:panel width="500" height="300">
			<w:iframe src="../stock/wmslocalshow.xhtml"></w:iframe>
		</layout:panel>
	</layout:window>

	<script>
	//<![CDATA[
	function setPiece(){
		var piece=piecedesc.getValue();
		alert(piece);
		pieceout.setValue(piece);
	}
	
	 function formatReport(v,m,r) {
	    	v="查看历史";
	        var temp = '<a  href="">' + v + '</a>';
	       // var temp = '<a href="./msgshow.xhtml?'+agrs+'" target="_blank">' + v + '</a>';
	    	//m.attr="style='color:blue;text-decoration: underline;'";
            return temp;
        }
	
     function formatReport(v,m,r) {
	    	var warehouseid=r.get('warehouseid');
            return temp;
        }
	
	  function  showLoc(){
	   window.showModalDialog("../stock/wmslocalshow.xhtml?temp=" + Math.random(),window,"dialogWidth:800px;status:no;dialogHeight:600px"); 
	  }
	  
	  function resize(){
			var newHeight = (gridPanelJsvar.getSize().height) - 75;
			var newWidth = (gridPanelJsvar.getSize().width);
			gridJsvar.setHeight(newHeight);
			gridJsvar.setWidth(newWidth);
			gridJsvar.render();
		}
	
		Ext.onReady(function(){
			resize();
			Ext.EventManager.onWindowResize(function(){
				resize();
			});
		 });
	//]]>
		</script>
</f:view>